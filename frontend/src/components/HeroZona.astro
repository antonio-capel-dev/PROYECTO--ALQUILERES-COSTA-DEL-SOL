---
import { IMAGENES_ZONA, IMAGEN_ZONA_FALLBACK } from "../config/zonas";
import { buildStrapiUrl } from "../utils/imagenes";
import Hero from "./ui/Hero.astro";
import { getLangFromUrl, useTranslations } from "../i18n/utils";

interface Props {
  nombre: string;
  slug: string;
  imagen?: { url: string };
  propiedadesCount?: number;
}

const { nombre, slug, imagen, propiedadesCount } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const cleanSlug = slug?.toLowerCase().trim();

let bgImage: string;

if (IMAGENES_ZONA[cleanSlug]) {
  bgImage = IMAGENES_ZONA[cleanSlug];
} else if (imagen?.url) {
  bgImage = buildStrapiUrl(imagen.url);
} else {
  bgImage = IMAGEN_ZONA_FALLBACK;
}

const subtitulo =
  propiedadesCount !== undefined
    ? t('zone.hero.available').replace('{count}', String(propiedadesCount))
    : undefined;
---

<Hero
  titulo={nombre}
  imagen={bgImage}
  subtitulo={subtitulo}
  badge={t('zone.hero.badge')}
  altura="banner"
/>
